# 2024년 1월 첫 주 수업 계획
- Spring 레거시, Spring 부트
- SNS 로그인, 공공 데이터 연결
- REST API 구축
- NextJS, React

# 1. MVC 패턴에서 엑셀 파일을 읽어 DB에 저장하기
## 1.1. Eclipse - MVC 패턴 세팅
Dynamic Web Project - Ex_0102_POI
### 1.1.1. 폴더
- Java Resources
	- src/main/java
		- ict.action
		- ict.control
		- mybatis.config
			- [[#1.1.7 config.xml|config.xml]]
		- mybatis.dao
			- [[#1.1.6. RegSubjectDAO.java|RegSubjectDAO.java]]
		- mybatis.mapper
			- [[#1.1.5. reg_subject.xml|reg_subject.xml]]
		- mybatis.service
			- FactoryService.java
		- mybatis.vo
			- BbsVO.java
			- CommVO.java
			- [[#1.1.4. RegSubjectVO.java|RegSubjectVO.java]]
- src
	- main
		- java
		- webapp
			- ex_upload
			- META-INF
			- WEB-INF
				- lib
					- <font color="#92cddc">commons-collections4-4.4.jar</font>
					- <font color="#92cddc">commons-compress-1.20.jar</font>
					- <font color="#c3d69b">cos.jar</font>
					- <font color="#c3d69b">jstl.jar</font>
					- <font color="#c3d69b">mybatis-3.5.14.jar</font>
					- <font color="#92cddc">ooxml-schemas-1.4.jar</font>
					- <font color="#92cddc">poi-5.0.0.jar</font>
					- <font color="#92cddc">poi-ooxml-5.0.0.jar</font>
					- <font color="#c3d69b">standard.jar</font>
					- <font color="#92cddc">xmlbeans-4.0.0.jar</font>
				- [[#1.1.3. Action.properties|Action.properties]]
### 1.1.2. MySQL Table 추가
```MySQL
-- MySQL dump 10.13  Distrib 8.0.34, for Win64 (x86_64)
--
-- Host: 127.0.0.1    Database: test_db
-- ------------------------------------------------------
-- Server version	8.0.35

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `reg_subject_t`
--

DROP TABLE IF EXISTS `reg_subject_t`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `reg_subject_t` (
  `s_idx` bigint NOT NULL AUTO_INCREMENT,
  `subject` varchar(45) DEFAULT NULL,
  `unit` varchar(45) DEFAULT NULL,
  `category` varchar(20) DEFAULT NULL,
  `teacher` varchar(45) DEFAULT NULL,
  `category_num` bigint DEFAULT NULL,
  `hour` bigint DEFAULT NULL,
  `room_num` varchar(10) DEFAULT NULL,
  `c_idx` bigint DEFAULT NULL,
  `status` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`s_idx`)
) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2023-12-29 20:06:43
```
### 1.1.3. Action.properties
#### 코드 전문
```
index=ict.action.IndexAction
reg=ict.action.RegAction
subjectReg=ict.action.SubjectAction
```
### 1.1.4. RegSubjectVO.java
#### 코드 전문
```java
package mybatis.vo;

public class RegSubjectVO {
	
	private String s_idx, subject, unit, category, teacher, category_num, hour, room_num, c_idx, status;

	public String getS_idx() {
		return s_idx;
	}

	public void setS_idx(String s_idx) {
		this.s_idx = s_idx;
	}

	public String getSubject() {
		return subject;
	}

	public void setSubject(String subject) {
		this.subject = subject;
	}

	public String getUnit() {
		return unit;
	}

	public void setUnit(String unit) {
		this.unit = unit;
	}

	public String getCategory() {
		return category;
	}

	public void setCategory(String category) {
		this.category = category;
	}

	public String getTeacher() {
		return teacher;
	}

	public void setTeacher(String teacher) {
		this.teacher = teacher;
	}

	public String getCategory_num() {
		return category_num;
	}

	public void setCategory_num(String category_num) {
		this.category_num = category_num;
	}

	public String getHour() {
		return hour;
	}

	public void setHour(String hour) {
		this.hour = hour;
	}

	public String getRoom_num() {
		return room_num;
	}

	public void setRoom_num(String room_num) {
		this.room_num = room_num;
	}

	public String getC_idx() {
		return c_idx;
	}

	public void setC_idx(String c_idx) {
		this.c_idx = c_idx;
	}

	public String getStatus() {
		return status;
	}

	public void setStatus(String status) {
		this.status = status;
	}

}
```
### 1.1.5. reg_subject.xml
<font color="#d99694">MySQL에서는</font> <font color="#92cddc">하나의 INSERT 문으로 여러 개의 레코드를 추가</font>할 수 있다.
- INSERT 문의 VALUES 값을 한 번에 여러 개 작성할 수 있다.
	```sql
	INSERT INTO reg_subjec_t (subject, unit, category, teacher, category_num, hour, room_num, c_idx, status)
	VALUES (value1, value2, value3, value4, value5, value6, value7, value8, value9),
		(value1, value2, value3, value4, value5, value6, value7, value8, value9),
		(value1, value2, value3, value4, value5, value6, value7, value8, value9),
		(value1, value2, value3, value4, value5, value6, value7, value8, value9)
	```

XML에서 반복문 사용
```xml
<foreach collection="list", item="vo" separator=",">
	<!-- 수행문 -->
</foreach>
```
- collection
- item
- separator : 구분자, 현재 코드는 쉼표로 구분한다.

INSERT 태그의 parameterType과 foreach 태그의 collection
```xml
<insert id="add" parameterType="Map">
	<!-- 중략 -->
	<foreach collection="list" item="vo" separator=",">
```
- parameterType을 Map으로 설정하였으나 foreach 문의 collection은 list이다.
- map의 key에 <font color="#fac08f">list</font>를, value에 RegSubjectVO 객체들을 담은 list가 저장된다. <font color="#fac08f">list</font>라는 키에서 vo 객체를 <font color="#92cddc">vo</font>라는 이름으로 가져와 vo 객체 내의 값을 가져오므로, 각각의 값 앞에는 <font color="#92cddc">vo</font>가 붙어서 `vo.subject`와 같이 작성되어야 한다. <font color="#d99694">???</font>

#### 코드 전문
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="reg_subject">
	<insert id="add" parameterType="Map">
		INSERT INTO reg_subject_t(subject, unit, category, teacher, 
			category_num, hour, room_num, c_idx, status)
		VALUES
		<foreach collection="list" item="vo" separator=",">
			(#{vo.subject}, #{vo.unit}, #{vo.category}, #{vo.teacher}, 
				#{vo.category_num}, #{vo.hour}, #{vo.room_num}, #{vo.c_idx}, 0)
		</foreach>
	</insert>
</mapper>
```
### 1.1.6. RegSubjectDAO.java
#### 코드 전문
```java
package mybatis.dao;

import java.util.HashMap;
import java.util.List;

import org.apache.ibatis.session.SqlSession;

import mybatis.service.FactoryService;
import mybatis.vo.RegSubjectVO;

public class RegSubjectDAO {
	public static int add(List<RegSubjectVO> list) {
		HashMap<String, List<RegSubjectVO>> map = 
			new HashMap<String, List<RegSubjectVO>>();
		map.put("list", list);
		
		SqlSession ss = FactoryService.getFactory().openSession();
		int cnt = ss.insert("reg_subject.add", map);
		if(cnt > 0) ss.commit();
		else ss.rollback();
		ss.close();
		
		return cnt;
	}
}
```
### 1.1.7 config.xml
#### 코드 전문
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE configuration
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
  <environments default="">
    <environment id="">
      <transactionManager type="JDBC"/>
      <dataSource type="JNDI">
        <property name="data_source" value="java:comp/env/jdbc/mysql"/>
      </dataSource>
    </environment>
  </environments>
  <mappers>
    <mapper resource="mybatis/mapper/reg_subject.xml"/>
  </mappers>
</configuration>
```
### 1.1.8 엑셀 파일 로드를 위한 절차 (라이브러리 세팅)
![[Pasted image 20240102104852.png]]
1행을 제외한 나머지 3개의 행의 값을 가져와야 한다.
[[#1.2. POI 라이브러리 등 설치 및 세팅 Excel|라이브러리 설치 과정]]을 참고하자.
### 1.1.9. Action.java
#### 코드 전문
```java
package ict.action;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public interface Action {
	String execute(HttpServletRequest request, HttpServletResponse response);
}
```
### 1.1.10. Controller.java
- Servlet File로 생성한다.
#### 코드 전문
```java
package ict.control;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.Properties;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import ict.action.Action;

/**
 * Servlet implementation class Controller
 */
@WebServlet(
		urlPatterns = { "/Controller" }, 
		initParams = { 
				@WebInitParam(name = "myParam", value = "/WEB-INF/Action.properties")
		})
public class Controller extends HttpServlet {
	private static final long serialVersionUID = 1L;
    private Map<String, Action> actionMap;
    /**
     * @see HttpServlet#HttpServlet()
     */
    public Controller() {
        super();
        actionMap = new HashMap<String, Action>();
    }
    
    @Override
    public void init() throws ServletException {
    	String props_path = getInitParameter("myParam");
    	ServletContext application = getServletContext();
    	String realPath = application.getRealPath(props_path);
    	Properties prop = new Properties();
    	FileInputStream fis = null;
    	
    	try {
    		fis = new FileInputStream(realPath);
    		prop.load(fis);
    	} catch (Exception e) {
    		e.printStackTrace();
    	}
    	
    	Iterator<Object> it = prop.keySet().iterator();
    	
    	while(it.hasNext()) {
    		String key = (String) it.next();
    		String value = prop.getProperty(key);
    		
    		try {
    			Object obj = Class.forName(value).newInstance();
    			actionMap.put(key, (Action) obj);
    		} catch (Exception e) {
    			e.printStackTrace();
    		}
    	}
    }

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		String type = request.getParameter("type");
		if(type == null) type = "index";
		
		Action action = actionMap.get(type);
		String viewPath = action.execute(request, response);
		if(viewPath == null) response.sendRedirect("Controller?type=list");
		else if(viewPath.length() > 4) {
			RequestDispatcher disp = request.getRequestDispatcher(viewPath);
			disp.forward(request, response);
		}
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		doGet(request, response);
	}

}
```
### 1.1.11. IndexAction.java
#### 코드 전문
```java
package ict.action;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class IndexAction implements Action {

	@Override
	public String execute(HttpServletRequest request, HttpServletResponse response) {
		
		return "/index.jsp";
	}

}
```
### 1.1.12. index.jsp
#### 코드 전문
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css"/>

<style>
	#basicModal{
		display: none;
	}
</style>
</head>
<body>
	<div id="wrap">
		<header>
			<h1>메인보드</h1>
		</header>
		<article>
			<button type="button" id="btn" data-izimodal-open="#basicModal">등록</button>
		</article>
		<!-- start modal -->
		<div class="iziModal" id="basicModal" data-izimodal-group="alerts">
			<div class="modal-dialog"> 
				<div class="modal-content">
					<div class="modal-body" id="modalContent">
						내용
					</div>
				</div>
			</div>
		</div>
		<!-- end modal -->
	</div>
	
	<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
	
	<script>
		$(function(){
			$("#btn").click(function(){
				console.log(mobilecheck());
				/* if(mobilecheck()){
					$('.modal-dialog').attr('style', "width:95%");
				}else{
					$('.modal-dialog').attr('style', "width:700px");
				} */
				
					
				$.ajax({
					url:"Controller?type=reg",
					type: "get"
				}).done(function(data){
					
					$("#modalContent").html(data);
					/* $('#basicModal').modal({
						  clickClose: false,
						  showClose: false,
						  });
				    $('#basicModal').modal('show');
				    $("#basicModal").draggable({
					      handle: ".panel-heading"
					}); */
					$('#basicModal').dialog({
						width: 790,
						height: 350,
					});
				});
				
			});
		});
		
		var mobilecheck = function () {
		     var check = false;
		     (function(a,b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
	     return check;
	    }
	</script>
</body>
</html>
```
### 1.1.13. reg.jsp
#### 코드 전문
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>


<!-- 팝업01_치환코드보기 -->
<div class="panel panel-inverse">
   <div class="panel-heading">
       <div class="panel-heading-btn">
           <div class="panel-heading-btn"> <a href="javascript:;" onclick="hidePageModal()" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove" data-original-title="" title=""><i class="fa fa-times"></i></a> </div>
       </div>
       <h4 class="panel-title">교과목 추가</h4>
   </div>
   <form class="form-horizontal" method="post" enctype="multipart/form-data"  data-parsley-validate="true" id="mForm" name="mForm" action="Controller?type=subjectReg">
   	   <input type="hidden" name="c_idx" value="13"/>
	   <div class="panel-body">
	       <div class="row">  
	       
	           <table class="table table-bordered">
	               <colgroup>
	                   <col width="15%">
	                   <col width="*">
	               </colgroup>
	               <tbody>
	                
	               <tr>
	                 <th scope="row" >엑셀파일:</th>
	                 <td  align="left" valign="middle"  colspan="3">
	                 	<input type="file" name="file"/>
	                 </td>
	               </tr>              
	               
	               </tbody>
	           </table>
	          
	   
	           <div class="popbtmbtn_section" id="auth_form_normal">
	               <div class="col-md-12" style="width:100%;text-align:center"> 
	                     <a type="button"  onclick="document.mForm.submit();"  class="btn btn-primary">저 장</a>
	                    <a type="button" onclick="hidePageModal()" class="btn btn-default">취 소</a>
	               </div>
	           </div>
	
	       </div>
	   </div>
   </form>
   </div> 
```
### 1.1.14 style.css
#### 코드 전문
```css
@charset "UTF-8";
.catBig{
	padding:3px;margin-bottom:5px;border:1px solid #cecece;cursor:pointer;
	-webkit-user-select: none;  
	-moz-user-select: none;    
	-ms-user-select: none;      
	user-select: none;
}
.catMiddle{padding-right:3px;padding-top:3px;padding-bottom:3px;margin-bottom:5px;border:1px solid #cecece;cursor:pointer;padding-right:-10px;}


.blue{color:#336699;}

.input_20{ border:1px solid #cecece;width:20px;height:2em}
.input_30{ border:1px solid #cecece;width:30px;height:2em}
.input_40{ border:1px solid #cecece;width:40px;height:2em}
.input_50{ border:1px solid #cecece;width:50px;height:2em}
.input_60{ border:1px solid #cecece;width:60px;height:2em}
.input_70{ border:1px solid #cecece;width:70px;height:2em}
.input_80{ border:1px solid #cecece;width:80px;height:2em}
.input_90{ border:1px solid #cecece;width:90px;height:2em}
.input_100{ border:1px solid #cecece;width:100px;height:2em}

.input_110{ border:1px solid #cecece;width:110px;height:2em}
.input_120{ border:1px solid #cecece;width:120px;height:2em}
.input_130{ border:1px solid #cecece;width:130px;height:2em}
.input_140{ border:1px solid #cecece;width:140px;height:2em}
.input_150{ border:1px solid #cecece;width:150px;height:2em}
.input_160{ border:1px solid #cecece;width:160px;height:2em}
.input_170{ border:1px solid #cecece;width:170px;height:2em}
.input_180{ border:1px solid #cecece;width:180px;height:2em}
.input_190{ border:1px solid #cecece;width:190px;height:2em}
.input_200{ border:1px solid #cecece;width:200px;height:2em}

.input_210{ border:1px solid #cecece;width:210px;height:2em}
.input_220{ border:1px solid #cecece;width:220px;height:2em}
.input_230{ border:1px solid #cecece;width:230px;height:2em}
.input_240{ border:1px solid #cecece;width:240px;height:2em}
.input_250{ border:1px solid #cecece;width:250px;height:2em}
.input_250{ border:1px solid #cecece;width:250px;height:26px}
.input_260{ border:1px solid #cecece;width:260px;height:2em}
.input_270{ border:1px solid #cecece;width:270px;height:2em}
.input_280{ border:1px solid #cecece;width:280px;height:2em}
.input_290{ border:1px solid #cecece;width:290px;height:2em}
.input_300{ border:1px solid #cecece;width:300px;height:2em}

.input_350{ border:1px solid #cecece;width:350px;height:2em}
.input_340{ border:1px solid #cecece;width:340px;height:2em}
.input_400{ border:1px solid #cecece;width:400px;height:2em}
.input_400{ border:1px solid #cecece;width:400px;height:2em}
.input_450{ border:1px solid #cecece;width:450px;height:2em}
.input_500{ border:1px solid #cecece;width:500px;height:2em}
.input_500{ border:1px solid #cecece;width:520px;height:2em}
.input_600{ border:1px solid #cecece;width:600px;height:2em}
.input_700{ border:1px solid #cecece;width:700px;height:2em}

.input_all{ border:1px solid #cecece;width:100%;height:2em}

.blueB{font-weight:bold; color:#336699;}


/* 20160808 �� �붿옄�� �듭씪�� �꾪븳 �쒓굅
.basicText {
    border: 1px solid #ccd0d4;
    -webkit-box-shadow: none;
    box-shadow: none;
    font-size: 12px;
    border-radius: 3px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    height: 32px;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857143;
    color: #555;
    background-color: #fff;
    background-image: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
    -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
}
*/
/*
.form-control {
    display: block;
    width: 100%;
    height: 34px;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857143;
    color: #555;
    background-color: #fff;
    background-image: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
    -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
}
*/

/* ------------------------- JINHWAN 異붽� ---------------------*/
@import url("http://fonts.googleapis.com/earlyaccess/nanummyeongjo.css");
textarea { resize:none; }
h4.panel-title { font-size:18px; font-weight:bold;}
/*h5 { padding-bottom:15px; margin:25px 0 20px; font-weight:bold; font-size:17px; border-bottom:2px solid #999;}*/
h5, h6 { padding-bottom:10px; margin:20px 0 0; font-weight:bold; font-size:16px; color:#333; border-bottom:1px solid #666; }
h7 { padding-bottom:5px; margin:20px 0 0; font-weight:bold; font-size:12px; display:block;}
.actionbtn_area {padding:20px; padding-top:0px; /*border-top:1px solid #eee;*/ height:auto; overflow:hidden; }
.actionbtn_area div { height:auto; overflow:hidden; }
.footeractbtn { padding:20px; height:auto; overflow:hidden; }
.panel-body .form-horizontal .tbl_type2 tbody td a { color:#39F; font-weight:bold; }
.panel-body .form-horizontal .tbl_type2 tbody td a:hover { color:#F90; }
.btn-white { background:#fff; border:1px solid #eee; color:#333; }
/* 紐⑤떖�앹뾽 愿��� */
.panel.panel-inverse { margin-bottom:0; }
/*.panel.panel-inverse .panel-body { padding-bottom:0; }*/
.popbtmbtn_section { margin-top:20px; padding:0;}

/* form �붿옄�� �섏젙 */
.parsley-errors-list { display: none; }
.radio-inline, .checkbox-inline { margin-right:20px; }
.radio-inline input { margin-top:0px; }
.checkbox-inline+.checkbox-inline, .radio-inline+.radio-inline { margin-left:0; }

.btn, button { border-radius:0px; }
.btn.btn-xs { padding:2px 5px 0; margin-top:-1px; line-height:normal; height:24px; }
.btn.btn-xs.btn-circle { padding:0px; width:20px; height:20px; line-height:20px; border-radius:50%;}

.form-control { border-radius:0; padding:1px 5px; line-height:normal; height:24px;}
input, select {  outline: none; /*border-radius:3px;*/ border:1px solid #ccd0d4; padding:1px 5px; line-height:normal; height:24px; }
textarea {  outline: none;  border:1px solid #ccd0d4; padding:1px 5px;  }
select { border-radus:5px; }
.input-sm, select.input-sm { padding:1px 5px; line-height:normal; height:24px; }
input[type=checkbox], input[type=radio] { height:auto; margin-top:2px; margin-left:10px }
input[type=file] { display:inline-block; vertical-align:middle; margin-bottom:-7px; }

/* 遺��몄뒪�몃옪 �뚮쭏 �섏젙 */
/*.btn.btn-default { padding:2px 5px 0; line-height:normal; height:25px; }*/


/* �� */
.tab-content { border-top:1px solid #ccc; }
.nav.nav-tabs { background:none;}
.nav-tabs>li.active>a, .nav-tabs>li.active>a:focus, .nav-tabs>li.active>a:hover { background:#ccc; cursor:pointer;}
.nav-tabs, .nav-tabs > li > a { background: #eee;}
.nav-tabs > li.active > a, .nav-tabs > li.active > a:focus { background: #CCC; font-weight:bold; }

/* �� 洹몃９ */
.tab-pane fade active in { background:#999; }
.form-group { background:#f5f7f9; }
.form-group div { background:#fff; height:auto; overflow:hidden; width:88%;}
.form-group .control-label { font-weight:bold; text-align:left; width:12%;}
.form-group .col-md-12.col-sm-12 { margin:0; width:100%;} 

/* �뚯씠釉� �붿옄�� 異붽� */
th { background:#f5f7f9; }
.table > thead > tr > th { text-align:center; vertical-align:middle !important; color:#666;}
.table > tbody > tr > th { text-align:left; vertical-align:middle !important;; width:15%; color:#666;}
.table > tbody > tr > th { text-align:left; vertical-align:middle !important;; }
.table > thead > tr > td { text-align:center; vertical-align:middle !important; }
.table-layer > tbody > tr > td { text-align:center; vertical-align:middle !important; }
.table-bordered > thead > tr > th { border-bottom-width:1px !important}
.table-bordered > thead > tr > td { border:1px solid #ddd !important;}
/*.table > tbody > tr > td { width:38%; }*/
/*.table.table-bordered tbody td:first-child {  font-weight:bold; text-align:left; width:12%; background:#f5f7f9; }*/
.tbl_type2 tfoot td { border:none; }


/* �좎씤�뺤콉 �뚯씠釉� 議곗젙 */
.discount.table tbody tr td { text-align:left; width:23%;}

.tbl_type,.tbl_type th,.tbl_type td{border:0}
.tbl_type{width:100%;border-bottom:2px solid #ff9333;font-size:12px;text-align:center;border-collapse:collapse}
.tbl_type caption{display:none}
.tbl_type tfoot{background-color:#fff6dd;font-weight:bold; color:#F00}
.tbl_type th{padding:7px 0 4px;border-top:2px solid #ff9333;border-right:1px solid #ff9333;border-left:1px solid #dfa046;background-color:#fff6dd;color:#b0421c;font-size:12px;font-weight:bold}
.tbl_type td{padding:6px 0 4px;border:1px solid #dfa046;color:#4c4c4c}
.tbl_type td.ranking{font-weight:bold}


.tbl_type2,.tbl_type2 th,.tbl_type2 td{border:0}
.tbl_type2{width:100%;border-bottom:2px solid #dcdcdc;font-size:12px;text-align:center;border-collapse:collapse}
.tbl_type2 caption{display:none}
.tbl_type2 tfoot{background-color:#FCFCFC;font-weight:bold; color:#F00}
.tbl_type2 th{padding:7px 0 4px;border-top:2px solid #dcdcdc;border-right:1px solid #dcdcdc;border-left:1px solid #dcdcdc;background-color:#f5f7f9;color:#666;font-size:12px;font-weight:bold; text-align:center;}
.tbl_type2 td{padding:6px 5px 4px;border:1px solid #e5e5e5;color:#4c4c4c; text-align:center;}
.tbl_type2 td.ranking{font-weight:bold}

.tbl_type3,.tbl_type3 th,.tbl_type3 td{border:0}
.tbl_type3{width:100%;border:1px solid #ff9333;font-size:12px;table-layout:fixed}
.tbl_type3 caption{display:none}
.tbl_type3 th{padding:8px 0 5px 20px;border-top:1px solid #ff9333;background:#fff6dd;color:#666;font-weight:bold;text-align:left;vertical-align:top}
.tbl_type3 td{padding:8px 5px 5px 12px;border-top:1px solid #ff9333;line-height:16px;vertical-align:top}

.tbl_type4,.tbl_type4 th,.tbl_type4 td{border:0}
.tbl_type4{width:100%;border:1px solid #dddee2;font-size:12px;table-layout:fixed}
.tbl_type4 caption{display:none}
.tbl_type4 th{padding:8px 0 5px 20px;border-top:1px solid #dddee2;background:#f1f1f3;color:#666;font-weight:bold;text-align:left;vertical-align:top}
.tbl_type4 td{padding:8px 5px 5px 12px;border-top:1px solid #dddee2;line-height:16px;vertical-align:top}

/* �섏씠吏� */
.paginate_complex{padding:15px 0;line-height:normal;text-align:center}
.paginate_complex a,
.paginate_complex strong{display:inline-block;position:relative;z-index:2;margin:0 -3px;padding:1px 8px;border-left:1px solid #d6d6d6;border-right:1px solid #d6d6d6;background-color:#fff;font:bold 12px/16px Tahoma, Sans-serif;color:#323232;text-decoration:none;vertical-align:top}
.paginate_complex a:hover,
.paginate_complex a:active,
.paginate_complex a:focus{background-color:#f8f8f8}
.paginate_complex strong{color:#ff8600}
.paginate_complex .direction{border:0;font-weight:normal;color:#767676;text-decoration:none !important;z-index:1}
.paginate_complex .direction:hover,
.paginate_complex .direction:active,
.paginate_complex .direction:focus{color:#323232;background-color:#fff;}
.paginate_complex .prev{border-left:0}
.paginate_complex .next{border-right:0}
.paginate_complex .direction span{display:inline-block;position:relative;top:4px;width:0;height:0;font-size:0;line-height:0;vertical-align:top}
.paginate_complex .prev span{*left:-4px;margin-right:1px;border:3px solid;border-top:solid #fff;border-bottom:solid #fff;border-left:0}
.paginate_complex .next span{margin-left:1px;border:3px solid;border-top:solid #fff;border-bottom:solid #fff;border-right:0}

/* �곷떒 top 蹂�寃� */
.top-menu { background:url(img/topmu_bg.png);}
.top-menu .nav > li > a {
    color: #b7d7f3;
}
.top-menu .nav > li:hover > a,
.top-menu .nav > li:focus > a,
.top-menu .nav > li > a:hover,
.top-menu .nav > li > a:focus {
    background: #227fcf;
	color: #fff;
}

/* �쇱そ 硫붾돱 蹂�寃� */
.sidebar { background:#7ebaee;}
.sidebar .sub-menu { background:#227fcf; }
.sidebar .sub-menu > li > a:before,
.sidebar .sub-menu > li > a { color: #b7d7f3; }
.navbar.navbar-inverse .navbar-brand, .sidebar .nav > li.active > a,
.sidebar .nav > li.active > a, .sidebar .nav > li.active > a:focus, .sidebar .nav > li.active > a:hover, .page-sidebar-minified .sidebar .nav > li.has-sub.active:focus > a, .page-sidebar-minified .sidebar .nav > li.has-sub.active:hover > a, .page-sidebar-minified .sidebar .nav > li.has-sub.active > a 
{ background:#00559f; }
.page-sidebar-minified .sidebar .nav li.has-sub > .sub-menu { background:#00559f; }

/* 硫붾돱 �묎린 �섏젙 */
.sidebar-minify-btn, a.sidebar-minify-btn:hover { background:#094981 !important; }

/* 蹂몃Ц ���댄� 諛� �섏젙 */
.panel-inverse > .panel-heading { background:#094981; }

/* �ㅻЦ吏� 愿��� */
.paperblock { padding:10px 0px; }
.papersubject span .num { font-size:16px; }
.papersubject { background:#F6F6F6; font-size:14px; font-weight:bold; color:#000; padding:10px 5px; }
.papercnt { padding:20px; }
.papersexp { padding:10px; margin:10px 0; font-size:14px; color:#333; border:1px solid #eee; }
.papergraph { padding:20px; }


/*�먭린�됯�*/
.paper_tit { font-size:16px; font-weight:bold; }

/*�덈젴�쇱�*/
.training { border:3px solid #000;}


.training_tit {text-align:center;font-family:�섎닎紐낆“, nanum myeongjo, georgia,�뗭�;padding-bottom:10px; margin:20px 0 0; font-weight:bold; font-size:30px; color:#333;letter-spacing:20px}
.training > tbody > tr > th { text-align:center; vertical-align:middle !important; color:#666;font-size:14px;}
.training > tbody > tr > td { font-size:12px;vertical-align:middle !important;}

.mw_loading{display:none;position:fixed;_position:absolute;top:0;left:0;width:100%;height:100%;z-index:999}
.mw_loading .bg{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;opacity:.5;filter:alpha(opacity=50)}
.mw_loading .fg{position:absolute;top:50%;left:50%;width:120px;height:120px;margin:-100px 0 0 -100px;padding:20px;border:0px solid #ccc;}
.mw_loading .fg img{width:100px}
.mw_loading .fg p.sns_icon{text-align:center}
.mw_loading .fg p.sns_icon a{display:inline-block;padding:10px 15px;}
.mw_loading .fg p input{border:#dedede solid 1px; background:#f3f3f3; padding:4px;color:#666; font-size:1em}


.stnav ul {list-style:none; margin:20px; }
.stnav ul li {float:left; margin-top:10px; margin-right:10px;}
.stnav ul li a:hover {text-decoration:none;}


.table-stu > thead > tr > th {background:#e5e5e5;}
.table-stu > thead > tr > td { border:1px solid #ddd !important; }

.table-stu-select {background:#333;}
.table-stu-select > thead > tr > th {background:#666666;}
.table-stu-select > thead > tr > td { color:#fff !important; border:1px solid #ddd !important;  }



.man{display:inline-block;margin-right:3px;padding:2px;width:12px;height:12px;font-size:0.55em;color:#fff;background:#032C94 !important;font-weight:bold; text-align:center; border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.woman{display:inline-block;margin-right:3px;padding:2px;width:12px;height:12px;font-size:0.55em;color:#fff;background:#ED091C !important;font-weight:bold; text-align:center; border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.endNotice{margin-right:5px;padding:2px;font-size:0.75em;color:#fff;background:#d14259 !important;font-weight:bold; text-align:center; border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;}



.rightgrey{background:#c7b699 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.violet{background:#a368de !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.pink{background:#df6c69 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.darkpink{background:#d14259 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.yellow{background:#fcb60b !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.rightyellow{background:#efdf68 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.rightblue{background:#7db1e4 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.emerald{background:#76c2c3 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.rightgreen{background:#c3db94 !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}
.darkblue{background:#4e8ede !important;display:inline-block;margin-left:10px;padding:2px;width:12px;height:12px;}

.rightgrey_circle{background:#c7b699 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.violet_circle{background:#a368de !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.pink_circle{background:#df6c69 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.darkpink_circle{background:#d14259 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.yellow_circle{background:#fcb60b !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.rightyellow_circle{background:#efdf68 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.rightblue_circle{background:#7db1e4 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.emerald_circle{background:#76c2c3 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.rightgreen_circle{background:#c3db94 !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}
.darkblue_circle{background:#4e8ede !important;display:inline-block;margin-left:0px;padding:2px;width:12px;height:12px;border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;}





#top_btn {
    position: fixed;
    top:200px;
    left: -20px;
    width: 100%;
    position: absolute;
    z-index: 999;
}

#top_btn .top_btn_wp {
    width: 710px;
    margin: 0 auto;
    position: absolute;
}

#top_btn .top_btn_wp a {
    position: absolute;
    display: inline-block;
}


#top_btn .top_btn_wp a.scroll-top{width:16px;height:18px;top:0;right:-70px;background:url('/worknet/images/idx_btn.png') -12px 0 no-repeat;text-indent:-9999px}
#top_btn .top_btn_wp a.scroll-top:hover{background:url('/worknet/images/idx_btn.png') -12px -27px no-repeat}
#top_btn .top_btn_wp a.scroll-bottom {width:16px;height:18px;top:44px;right:-70px;background:url('/worknet/images/idx_btn.png') -30px -27px no-repeat;text-indent:-9999px}
#top_btn .top_btn_wp a.scroll-bottom:hover {background:url('/worknet/images/idx_btn.png') -30px 0 no-repeat}
#top_btn .top_btn_wp a.scroll-center {width:8px;height:8px;top:27px;right:-66px;background:url('/worknet/images/idx_btn.png') no-repeat;text-indent:-9999px}
#top_btn .top_btn_wp a.scroll-center:hover {background:url('/worknet/images/idx_btn.png') 0 -27px no-repeat}
```
### 1.1.15. RegAction.java
#### 코드 전문
```java
package ict.action;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class RegAction implements Action {

	@Override
	public String execute(HttpServletRequest request, HttpServletResponse response) {
		
		return "/reg.jsp";
	}

}
```
### 1.1.16. SubjectAction.java
파일이 첨부되어 오는 경우
- `request.getContentType()`을 했을 때 "multipart"로 시작되는 문장이 넘어온다.
- 파일이 저장될 위치는 절대경로로 준비되어야 한다.
	```java
	ServletContext application = request.getServletContext();
	String realPath = application.getRealPath(dir);
	```
	- 이때 dir은 첨부파일을 받을 경로이다. 이를 절대경로로 바꾸어 realPath에 저장한다.

> [!faq] <font color="#d99694">파일 처리가 끝나면 첨부 파일을 삭제한다?</font>
> DefaultFileRenamePolicy를 사용하면 중복된 파일 이름을 자동으로 변경하여 업로드 디렉토리에 저장한다. 이 경우 업로드가 끝나면 기존의 파일이나 중복된 파일이 업로드 디렉토리에 남을 수 있다. 이때 파일 처리가 끝났다면 중복되거나 불필요한 파일을 삭제하는 작업을 추가로 수행할 수 있다.
> 또는 업로드된 파일을 임시로 저장하고, 일정 기간이 지나면 더이상 필요하지 않다고 판단하여 파일을 삭제할 수도 있다.

첨부파일과 나머지 파라미터를 받아야 한다.
```java
MultipartRequest mr = new MultipartRequest(
	request, realPath, 1024*1024*5, "utf-8", new DefaultFileRenamePolicy());
```
- 위에서 구한 절대 경로를 MultipartRequst 객체에 저장한다.
- 이 단계에서 첨부 파일은 업로드 폴더에 올라간 상태이다.
```java
String c_idx = mr.getParameter("c_idx");
```
- 첨부파일을 제외한 나머지 파라미터를 받는다.
- c_idx를 통해 과정 기본키를 받아온다.
```java
File f = mr.getFile("file");
String fname = null;
if(f != null) {
	fname = f.getName(); // 저장된 파일명
	FileInputStream fis = new FileInputStream(f.getAbsolutePath());
	IOUtils.setByteArrayMaxOverride(Integer.MAX_VALUE);
}
```

> [!faq] IOUtils가 무엇이고 이 코드의 역할은?
> Apache Commons IO 라이브러리의 `IOUtils` 클래스에서 사용되는 설정 중 하나로, `ByteArrayOutputStream`의 최대 크기에 재한을 해제하도록 설정하는 것이다.
> `ByteArrayOutputStream`은 메모리 내에서 데이터를 바이트 배열에 저장하는 스트림으로, 일반적으로 Java에서는 작은 크기의 데이터를 메모리에 캐시하거나 조작하는 데 유옹하나, 기본적으로는 크기에 제한이 있다.
> `IOUtils.setByteArrayMaxOverride(Integer.MAX_VALUE);`를 호출함으로써 최대 크기 제한이 해제되어 `ByteArrayOutputStream`이 정수의 최대값인 2,147,483,647 바이트까지 저장할 수 있게 된다.

데이터 유실 없이 가져올 수 있도록 세팅을 한다.
```java
XSSFWorkbook workbook = new XSSFWorkbook(fis); // 1.
XSSFSheet sheet = workbook.getSheetAt(0); // 2.
Iterator<Row> rowIterator = sheet.iterator(); // 3.
List<RegSubjectVO> list = new ArrayList<RegSubjectVO>(); // 4.
```
1. 확장자가<font color="#92cddc"> xlsx이면 XSSFWorkbook</font>을 사용하고, xls이면 HSSFWorkbook을 사용해야 한다.
2. 해당 파일의 첫 번째 Sheet를 얻어낸다. `getSheetAt(0)`은 첫 번째 Sheet를 얻어낸다.
3. [[#1. Iterator|반복자]]<font color="#7f7f7f">(Iterator)</font>로 수행할 행 정보를 얻어낸다. 이때 ROW는 `org.apache.poi.ss.usermodel.Row`이다.
4. 얻은 행 정보를 ArrayList로 받아야한다.
```java
while(rowIterator.hasNext()) { // 1.
	Row row = rowIterator.next(); // 2.
	if(row.getRowNum() == 0) continue;
}
```
1. 반복문을 돌린다. `hasNext()`를 꼭 기억하자.
2. `next()`를 이용해 하나의 행을 얻어낸다. 이때 헤드인 첫 번째 행은 if 문을 이용해 수행하지 않도록 한다.
```java
Iterator<Cell> cellIterator = row.cellIterator(); // 1.
RegSubjectVO vo = new RegSubjectVO();

int i = 0;
while(cellIterator.hasNext()) { // 2.
	Cell cell = cellIterator.next();
	String value = null;
	
	switch(cell.getCellType()) {
		case NUMERIC:
			value = String.valueOf(cell.getNumericCellValue());
			break;
		case STRING:
			value = cell.getStringCellValue();
			break;
		case BLANK:
			value = null;
}
```
1. 한 행의 cell을 한 번에 반복자로 얻어낸다.
2. while 문을 이용해 각 cell 값을 가져와 vo 객체에 저장한다.
3. `getCellType()`에 의해 switch 문으로 자료형에 따라 구분한다. NUMERIC, STRING, BLANK에 따라 구분한다.

vo에 현재 셀 값을 저장해야 한다.
- `i == 0` > subject
- `i == 1` > unit
- `i == 2` > category ...
```java
switch(i) {
	case 0:
		vo.setSubject(value);
		break;
	case 1:
		vo.setUnit(value);
		break;
	case 2:
		vo.setCategory(value);
		break;
	case 3:
		vo.setTeacher(value);
		break;
	case 4:
		vo.setCategory_num(value);
		break;
	case 5:
		vo.setHour(value);
		break;
	case 6:
		vo.setRoom_num(value);
		break;
}
++i;
```
- switch 문이 끝나면 cell의 index 값을 증가시킨다.

첨부한 엑셀 파일의 행들을 모두 vo로 생성하여 list에 저장하였다.
이 list에 있는 정보들을 DB에 저장하기 위해 DAO를 호출한다.

```java
RegSubjectDAO.add(list);
fis.close();
```
- 사용을 완료한 fis를 닫아준다.

#### 코드 전문
```java
package ict.action;

import java.io.File;
import java.io.FileInputStream;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import javax.servlet.ServletContext;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.util.IOUtils;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;

import mybatis.dao.RegSubjectDAO;
import mybatis.vo.RegSubjectVO;

public class SubjectAction implements Action {

	@Override
	public String execute(HttpServletRequest request, HttpServletResponse response) {
		
		String dir = "/ex_upload";
		String viewPath = null;
		String enc_type = request.getContentType();
		
		if(enc_type.startsWith("multipart")) { // 파일이 첨부된 경우
			try {
				ServletContext application = request.getServletContext();
				String realPath = application.getRealPath(dir);
				MultipartRequest mr = new MultipartRequest(request, realPath, 1024*1024*5, "utf-8", new DefaultFileRenamePolicy());
				String c_idx = mr.getParameter("c_idx");
				
				File f = mr.getFile("file");
				String fname = null;
				if(f != null) {
					fname = f.getName(); // 저장된 파일명
					FileInputStream fis = new FileInputStream(f.getAbsolutePath());
					IOUtils.setByteArrayMaxOverride(Integer.MAX_VALUE);
					
					XSSFWorkbook workbook = new XSSFWorkbook(fis);
					XSSFSheet sheet = workbook.getSheetAt(0);
					Iterator<Row> rowIterator = sheet.iterator();
					List<RegSubjectVO> list = new ArrayList<RegSubjectVO>();
					
					while(rowIterator.hasNext()) {
						Row row = rowIterator.next();
						if(row.getRowNum() == 0) continue;
						
						Iterator<Cell> cellIterator = row.cellIterator();
						RegSubjectVO vo = new RegSubjectVO();
						
						int i = 0;
						while(cellIterator.hasNext()) {
							Cell cell = cellIterator.next();
							String value = null;
							
							switch(cell.getCellType()) {
								case NUMERIC:
									value = String.valueOf(cell.getNumericCellValue());
									break;
								case STRING:
									value = cell.getStringCellValue();
									break;
								case BLANK:
									value = null;
							}
							
							switch(i) {
								case 0:
									vo.setSubject(value);
									break;
								case 1:
									vo.setUnit(value);
									break;
								case 2:
									vo.setCategory(value);
									break;
								case 3:
									vo.setTeacher(value);
									break;
								case 4:
									vo.setCategory_num(value);
									break;
								case 5:
									vo.setHour(value);
									break;
								case 6:
									vo.setRoom_num(value);
									break;
							}
							++i;
						}
						vo.setC_idx(c_idx);
						list.add(vo); // list에 vo를 저장
					}
					RegSubjectDAO.add(list);
					fis.close();
					f.delete();
				}
			} catch (Exception e) {
				e.printStackTrace();
			}
		}
		
		return viewPath;
	}

}
```
## 1.2. POI 라이브러리 등 설치 및 세팅 #Excel
> [!caution] POI 라이브러리
> 버전을 매우 탑니다.

### 1.2.1. POI 라이브러리 검색 및 다운
1. [아파치](https://www.apache.org/)로 이동
2. APACHE PROJECT LIST > POI
3. Download > Release Archives > Binary Artifacts
4. ~~poi-bin-5.2.3-20220909.zip~~
5. poi-bin-5.0.0-20210120.zip ([여기](https://archive.apache.org/dist/poi/release/bin/)서 확인)
6. 압축 해제 > poi-5.0.0 폴더 확인
7. <font color="#c3d69b">poi-5.0.0.jar</font>, <font color="#b2a2c7">poi-ooxml-5.0.0.jar</font>
8. poi-bin-5.2.3 > ooxml-lib > <font color="#c3d69b">commons-compress-1.20.jar</font>, <font color="#b2a2c7">xmlbeans-4.0.0.jar</font>
9. poi-bin-5.2.3 > lib > <font color="#c3d69b">commons-collections4-4.4.jar</font>
10. 위 5개 파일 lib 폴더에 복사
### 1.2.2. 스키마 라이브러리 검색 및 다운
1. <font color="#d99694">(중요)</font> [MVN repository](https://mvnrepository.com/)로 이동
2. "ooxml-schemas" 검색
3. OOXML Schemas 선택 > version 1.4 > Files > jar > 다운로드 진행됨
4. <font color="#c3d69b">ooxml-schemas-1.4.jar</font> 파일 lib 폴더에 복사

# 참고
## 1. Iterator
- 컬렉션을 순회하는 데 사용되는 인터페이스
- 순차적으로 컬렉션의 요소에 접근할 수 있도록 한다.
### 1.2. hasNext() METHOD #Iterator #method
- 현재 위치에서 다음 요소가 있는지 확인한다.
- 다음 요소가 있다면 `true`를 반환하고, 없으면 `false`를 반환한다.
- 일반적으로 반복문과 함께 사용되어 아래와 같이 구현된다.
	```java
	Iterator<T> iterator = collection.iterator();
	while (iterator.hasNext()) {
	    T element = iterator.next();
	    // element를 사용한 작업 수행
	}
	```